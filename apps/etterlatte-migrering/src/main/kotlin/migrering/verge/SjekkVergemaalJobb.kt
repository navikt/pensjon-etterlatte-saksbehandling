package no.nav.etterlatte.migrering.verge

import no.nav.etterlatte.libs.common.person.PersonRolle
import no.nav.etterlatte.libs.common.toJson
import no.nav.etterlatte.migrering.PesysRepository
import no.nav.etterlatte.migrering.verifisering.PDLKlient
import no.nav.etterlatte.rapidsandrivers.migrering.PesysId
import kotlin.concurrent.thread

internal class SjekkVergemaalJobb(private val pdlKlient: PDLKlient, private val repository: PesysRepository) {
    fun sjekkMuligeProblemsaker() {
        thread {
            Thread.sleep(60_000)
            muligeProblemsaker.forEach { sjekkVergemaal(it) }
        }
    }

    private fun sjekkVergemaal(sakId: Long) {
        val sak = repository.hentSak(sakId)!!
        val resultatFraPDL = pdlKlient.hentPerson(PersonRolle.BARN, sak.soeker)
        if (resultatFraPDL.vergemaalEllerFremtidsfullmakt?.isNotEmpty() == true) {
            repository.lagreFeilkjoering(
                request = sak.toJson(),
                feilendeSteg = "EkstraVergesjekk",
                feil = "Person har vergem√•l eller fullmakt som vi ikke oppdaga ved forrige sjekk",
                pesysId = PesysId(sak.id),
            )
        }
    }

    val muligeProblemsaker =
        listOf<Long>(
            25710467,
            25711106,
            25745514,
            25780251,
            25642574,
            25607056,
            25700434,
            25591725,
            25582259,
            25688803,
            24143561,
            24680133,
            25325414,
            25386244,
            25153636,
            25315520,
            24869415,
            25305897,
            24612052,
            25336459,
            24505066,
            24528159,
            24976398,
            25115417,
            25083949,
            24957402,
            24834865,
            25049872,
            24955633,
            25746789,
            25646370,
            25719784,
            25532042,
            25717646,
            25517081,
            25517575,
            25735056,
            25721266,
            25748192,
            25711031,
            25724024,
            25566117,
            25646880,
            25646910,
            25506846,
            25176587,
            25644810,
            25514683,
            25691992,
            25571044,
            25777731,
            25608313,
            25790009,
            25698795,
            25420780,
            25768067,
            25789342,
            25700865,
            14774242,
            22224501,
            14212574,
            20032469,
            20108026,
            20108775,
            20122373,
            20122133,
            20512894,
            20207888,
            20154338,
            20164203,
            20635619,
            20654630,
            20622132,
            20701804,
            21121439,
            21076943,
            21091358,
            21015791,
            21441098,
            21447491,
            21643703,
            21646151,
            21647352,
            21491502,
            21495225,
            21495226,
            21421402,
            22071918,
            21740499,
            21842634,
            22038285,
            20037909,
            21596412,
            22356350,
            20130368,
            25055025,
            25788920,
            25780246,
            25812502,
            25810296,
            25810297,
            25812305,
            25812306,
            25816057,
            25812498,
            25812499,
            25792581,
            25792582,
            20550638,
            21965461,
            21965462,
            21789923,
            22153294,
            22153575,
            21790667,
            21790684,
            22199900,
            22206754,
            22042870,
            22042989,
            22168674,
            22404253,
            22243396,
            22251873,
            22466234,
            22285661,
            22286232,
            22272960,
            21931006,
            21861201,
            22160302,
            22160902,
            22161101,
            22452818,
            22560287,
            20603863,
            22583716,
            22588442,
            22589255,
            21583733,
            22366367,
            22366368,
            22462042,
            21933369,
            22463177,
            22610537,
            21970953,
            23789209,
            22257932,
            22090436,
            22740567,
            20204163,
            22601097,
            22255496,
            22089637,
            23728273,
            22258116,
            22258115,
            22260312,
            22258090,
            22259272,
            22785399,
            24088324,
            24093835,
            23969226,
            21998240,
            24021217,
            24021219,
            22469360,
            24099159,
            24103817,
            24213165,
            23946357,
            24503995,
            24172246,
            25455070,
            25455088,
            25316008,
            21871219,
            14201148,
            24821208,
            24821209,
            24821210,
            24172248,
            25342564,
            24783434,
            25068850,
            24680373,
            22251398,
            22257920,
            24775051,
            24482999,
            14126617,
            22510910,
            23751175,
            24896729,
            22198597,
            22202801,
            24054475,
            24342959,
            21718019,
            24930541,
            24930545,
            22366769,
            22061766,
            22366273,
            24680359,
            25169000,
            25030834,
            25523552,
            25630152,
            23801891,
            25557674,
            25560044,
            25431927,
            23801895,
            25605304,
            25711654,
            23805361,
            25642693,
            22697569,
            25422258,
            22697199,
            25342682,
            25500816,
            25121103,
            25646875,
            25448463,
            23801889,
            22659569,
            25781152,
            22465654,
            25634703,
            25605758,
            25514060,
            25681992,
            25566146,
            21377121,
            22465659,
            22465655,
            25538393,
            23801893,
            25467987,
            22659571,
            25566513,
            25550094,
            25559799,
            25446092,
            25596147,
            25504586,
            25605742,
            23805359,
            21436338,
            25579876,
            25347512,
            25579877,
            21268936,
            25431926,
            25634486,
            25526688,
            25571194,
            23953197,
            23789175,
            25741564,
            25809648,
            25558861,
            25741563,
            25805101,
            25566304,
            21933366,
            14432882,
            20012025,
            20191330,
            20200818,
            20200823,
            20520127,
            20688948,
            20628914,
            20628915,
            20702217,
            21150323,
            21117001,
            21349751,
            21550948,
            21296751,
            21562066,
            21320113,
            21611766,
            21611767,
            21940254,
            21843467,
            22089634,
            22089848,
            21772020,
            22211470,
            22224406,
            22223504,
            22028912,
            22237819,
            22161207,
            22270877,
            22272610,
            21623858,
            23079519,
            22961577,
            23943829,
            23936975,
            25325261,
            25325262,
            25366444,
            25366446,
            24476965,
            24948957,
            24948958,
            25055586,
            24881017,
            25691181,
            25556636,
            25730859,
            21721306,
            21266987,
            21940272,
            21940368,
            22095523,
            21879006,
            22005043,
            22005753,
            21878307,
            22273633,
            24096987,
            21971083,
            24908421,
            24908422,
            21208456,
            25029632,
            25029633,
            21971082,
            21381204,
            21851110,
            21971034,
            24908420,
            24908424,
            24870233,
            25308061,
            25514879,
            25308062,
            25515154,
            20059975,
            22405406,
            22390151,
            22394451,
            20124703,
            20203352,
            20209041,
            20655064,
            21224423,
            21541911,
            21361764,
            21448006,
            21305454,
            21577646,
            21494411,
            21317647,
            21583116,
            21583117,
            21583702,
            21521394,
            22050105,
            22050604,
            21725902,
            21725951,
            21831772,
            21849364,
            21879055,
            21772148,
            21772360,
            21798989,
            21922642,
            22512563,
            22512564,
            22070704,
            22070705,
            22155145,
            22155147,
            22471324,
            22470335,
            22476580,
            22478062,
            22656195,
            22656197,
            22656199,
            22656201,
            23551628,
            23551630,
            24094978,
            24038435,
            23889844,
            24761669,
            25083572,
            20078164,
            25271979,
            24696825,
            25307334,
            25307335,
            25067647,
            25067648,
            21320382,
            24852494,
            22398356,
            22398978,
            24546979,
            24546980,
            25100069,
            25121030,
            25121032,
            25121033,
            25121034,
            24877437,
            24949839,
            24684400,
            25055592,
            25055593,
            25055594,
            25055595,
            25192208,
            25261828,
            25261829,
            25261830,
            25022846,
            25022848,
            25022849,
            21160366,
            25620551,
        )
}
